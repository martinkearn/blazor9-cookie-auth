@page "/login"
@rendermode InteractiveServer
@inject HttpClient Http

<input @bind="secret" class="form-control mb-2" placeholder="Enter secret" />
<button class="btn btn-primary" @onclick="LoginUser">Login</button>
<p>@log</p>

<AuthorizeView>
    <Authorized>
        <p>Logged in</p>
    </Authorized>
    <NotAuthorized>
        <p>Not logged in</p>
    </NotAuthorized>
</AuthorizeView>

@code {
    private string secret = string.Empty;
    private string? log = "";

    private async Task LoginUser()
    {
        log += secret;
        StateHasChanged();
        var content = JsonContent.Create(secret);
        var response = await Http.PostAsync("https://localhost:7237/api/auth/login", content);
        log += response.StatusCode;
        StateHasChanged();

        if (response.IsSuccessStatusCode)
        {
            log += "Logged in";
        }
        else
        {
            log += "Invalid secret.";
        }
        StateHasChanged();
    }
}